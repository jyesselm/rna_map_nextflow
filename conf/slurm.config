/*
 * SLURM cluster execution profile
 * 
 * Use this profile for running on a SLURM cluster.
 * 
 * Usage:
 *   nextflow run main.nf -profile slurm --fasta ref.fasta --fastq1 reads.fastq
 *   nextflow run main.nf -profile slurm --account myaccount --partition normal --fasta ref.fasta --fastq1 reads.fastq
 */

process {
    executor = 'slurm'
    
    // Default resource limits
    cpus = { task.cpus ?: 4 }
    memory = { task.memory ?: '8 GB' }
    time = { task.time ?: '2h' }
    
    // SLURM-specific settings
    clusterOptions = { 
        def opts = []
        if (params.account) {
            opts << "--account=${params.account}"
        }
        if (params.partition) {
            opts << "--partition=${params.partition}"
        }
        opts.join(' ')
    }
    
    // Resource limits
    maxForks = params.max_cpus ?: 16
    maxRetries = 3
    errorStrategy = 'retry'
}

// Include base configuration
includeConfig 'conf/base.config'

